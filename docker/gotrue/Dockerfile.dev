# GoTrue - Development Dockerfile
FROM supabase/gotrue:v2.31.0

# Install development tools
RUN apk add --no-cache curl jq

# Configure the service
ENV GOTRUE_DB_DRIVER=postgres
ENV GOTRUE_API_HOST=0.0.0.0
ENV GOTRUE_API_PORT=9999
ENV GOTRUE_DISABLE_SIGNUP=false
ENV GOTRUE_JWT_EXP=3600
ENV GOTRUE_JWT_DEFAULT_GROUP_NAME=authenticated
ENV GOTRUE_MAILER_AUTOCONFIRM=true
ENV GOTRUE_LOG_LEVEL=debug

# Expose GoTrue port
EXPOSE 9999

# Health check
HEALTHCHECK --interval=10s --timeout=5s --retries=3 \
    CMD curl -f http://localhost:9999/health || exit 1